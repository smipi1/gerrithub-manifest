#!/bin/sh

fakeInterfaceUp() {
        proto_init_update "*" 1
        proto_send_update "$INTERFACE"
}

case "$1" in
        deconfig)
                /etc/init.d/avahi-autoipd restart
                
                # netifd doesn't know about Avahi, which will bring the interface up.
                # Avahi doesn't know how to interact with netifd, so do this here:
                fakeInterfaceUp
                ;;
        renew|bound)
                /etc/init.d/avahi-autoipd stop
                ;;
esac
